<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Microsoft Office论文排版技巧 | 止于至善</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Microsoft Office论文排版技巧" />
<meta name="author" content="Jihuan Tian" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Table of contents" />
<meta property="og:description" content="Table of contents" />
<link rel="canonical" href="https://jihuan-tian.github.io/computer/2009/04/19/Microsoft-Office%E8%AE%BA%E6%96%87%E6%8E%92%E7%89%88%E6%8A%80%E5%B7%A7.html" />
<meta property="og:url" content="https://jihuan-tian.github.io/computer/2009/04/19/Microsoft-Office%E8%AE%BA%E6%96%87%E6%8E%92%E7%89%88%E6%8A%80%E5%B7%A7.html" />
<meta property="og:site_name" content="止于至善" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2009-04-19T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Microsoft Office论文排版技巧" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jihuan Tian"},"dateModified":"2009-04-19T00:00:00+08:00","datePublished":"2009-04-19T00:00:00+08:00","description":"Table of contents","headline":"Microsoft Office论文排版技巧","mainEntityOfPage":{"@type":"WebPage","@id":"https://jihuan-tian.github.io/computer/2009/04/19/Microsoft-Office%E8%AE%BA%E6%96%87%E6%8E%92%E7%89%88%E6%8A%80%E5%B7%A7.html"},"url":"https://jihuan-tian.github.io/computer/2009/04/19/Microsoft-Office%E8%AE%BA%E6%96%87%E6%8E%92%E7%89%88%E6%8A%80%E5%B7%A7.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/htmlize-syntax-highlight.css">
  
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico?">
  <link href="https://fonts.googlefonts.cn/css?family=EB+Garamond" rel="stylesheet"><link type="application/atom+xml" rel="alternate" href="https://jihuan-tian.github.io/feed.xml" title="止于至善" />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">止于至善</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <!-- Comment out the default sorted categories. -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--         <a class="page-link" href="/about/">About</a> -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--         <a class="page-link" href="/computer/">Computer</a> -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--         <a class="page-link" href="/math/">Math</a> -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--         <a class="page-link" href="/tags/">Tags</a> -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--         <a class="page-link" href="/thoughts/">Thoughts</a> -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          <!---->
          <!--      -->
          <!---->
          <!--      -->
          <!---->
          
          <!-- Enforce a fixed order for my categories. -->
          <a class="page-link" href="/math/">Math</a>
          <a class="page-link" href="/computer/">Computer</a>
          <a class="page-link" href="/thoughts/">Thoughts</a>
          <a class="page-link" href="/tags/">Tags</a>
          <a class="page-link" href="/about/">About</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Microsoft Office论文排版技巧</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2009-04-19T00:00:00+08:00" itemprop="datePublished">Apr 19, 2009 &nbsp;

        
          Categories:
          
            <a href="/computer">Computer</a>
          
         &nbsp;
        
          Tags:
          
            <a href="/tags/MS-Office">MS-Office</a>
          
            <a href="/tags/排版">排版</a>
          
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h1 class="no_toc" id="table-of-contents">Table of contents</h1>

<ul id="markdown-toc">
  <li><a href="#引言" id="markdown-toc-引言">引言</a></li>
  <li><a href="#样式与格式" id="markdown-toc-样式与格式">样式与格式</a></li>
  <li><a href="#公式图表的编号与引用" id="markdown-toc-公式图表的编号与引用">公式、图、表的编号与引用</a>    <ul>
      <li><a href="#公式自动编号" id="markdown-toc-公式自动编号">公式自动编号</a></li>
    </ul>
  </li>
  <li><a href="#公式图片表格的排版" id="markdown-toc-公式图片表格的排版">公式、图片、表格的排版</a>    <ul>
      <li><a href="#公式的排版" id="markdown-toc-公式的排版">公式的排版</a></li>
      <li><a href="#图片的排版" id="markdown-toc-图片的排版">图片的排版</a></li>
      <li><a href="#表格的排版" id="markdown-toc-表格的排版">表格的排版</a></li>
    </ul>
  </li>
  <li><a href="#excel-chart的处理" id="markdown-toc-excel-chart的处理">Excel chart的处理</a></li>
  <li><a href="#参考文献的编排" id="markdown-toc-参考文献的编排">参考文献的编排</a></li>
  <li><a href="#mathtype的使用" id="markdown-toc-mathtype的使用">MathType的使用</a>    <ul>
      <li><a href="#mathtype-6与公式的快速输入" id="markdown-toc-mathtype-6与公式的快速输入">MathType 6与公式的快速输入</a></li>
      <li><a href="#mathtype的中文输入" id="markdown-toc-mathtype的中文输入">MathType的中文输入</a></li>
    </ul>
  </li>
  <li><a href="#结语" id="markdown-toc-结语">结语</a></li>
  <li><a href="#附录1-word-vba-macros" id="markdown-toc-附录1-word-vba-macros">附录1 Word VBA macros</a></li>
  <li><a href="#附录2--excel-vba-macros" id="markdown-toc-附录2--excel-vba-macros">附录2  Excel VBA macros</a></li>
</ul>

<h1 id="引言">引言</h1>

<p>经过了一个多月的”煎熬”，终于将博士论文撰写完毕并打印成册了。由于之前撰写博士课题结题报告就用的是Microsoft Office，自己也不想再麻烦，所以博士论文就直接基于该Word文档做了，也没有再使用TeX/LaTeX排版。准确地讲，排版这件事其实比不上我们去学习数学、物理或编程序等给自己带来的收获大。可能你投入了数天的气力去调整文档格式，最终只是得到了一个”通过论文格式审查”的必然结果。毕竟，排版的目的是为了”秀”给别人看的，于自己的益处不多，而且对于面临要毕业工作不搞科研的大多数同学来讲，可能就只这么一次撰写大论文的机会，因而排版就更是一件”吃力不讨好”的事情了。但正因为如此，这里把自己在此次排版博士论文过程中的一些小经验、小技巧总结出来以享诸位，以期能够提高大家今后撰写论文的效率，尽量减少在这件”吃力不讨好的事情”上所浪费的时间。</p>

<p>同时，需要说明的是，撰写本文的目的绝对不是为了向大家宣传使用盗版Microsoft Office，也绝对不是为了向大家宣传使用正版Microsoft Office。因此，本文的撰写采用的是GNU/Linux下的Openoffice办公套装软件，除了与Microsoft Office不能完全兼容外，其完全可以替代Microsoft Office，满足日常科研和学习的需求。</p>

<p>下面言归正传，介绍Word排版中的小技巧，其中许多内容都是通过VBA宏来实现的，可以大大减少我们的工作量。</p>

<h1 id="样式与格式">样式与格式</h1>

<p>对于带有格式的文档，文档内容与样式的分离是保证文档格式的统一、可变、易维护的关键。在撰写文档时，我们只需关心如何安排各部分之间的逻辑关系、组织结构，而暂时不需要考虑段落与文字的样式。确定出文档的整体框架后，就可以针对每个组织单元进行样式的设计。例如，一个文档可以分为文章题目、各级标题、正文文字、要点内容等四大部分，那么就可以分别为这四类逻辑内容设置相应的样式。这样做的好处是，我们可以设置不同的样式集，从而在保证文档内容不变的情况下得到不同排版效果的文档。例如，可以针对同一文档内容，分别制作出用于论文打印和会议海报的样式。在Microsoft Word中样式的创建与修改是通过”格式”菜单中的”样式与格式”来完成的。在撰写最终的毕业论文前，一定要先定义好文档所需的样式（可以先只起好样式的名字，等文章写完后再调整与各样式对应的段落与文字格式），而不要像许多人通常的做法：随手选中某一部分文字直接修改其样式，或者使用格式刷将样式刷来刷去，这样做的后果会很惨，很容易导致整个文档的格式全部乱掉，重新调整起来异常困难。而若事先定义好了与文档各逻辑组成部分对应的样式，则只要将该样式的定义内容进行修改，则全文中所有采用该样式的地方都会得到相应更新，这样做既省事、又安全可靠。举例说，我在博士论文中就分别设定了如下样式：一、二、三级标题，一行放置单个图片与一行并排放置两个图片的样式，图片与表格题注样式，参考文献条目样式，公式所在段落的样式等。</p>

<p>关于样式定义或修改对话框中的”自动更新”选项这里需要说明一下：若选中了该选项，则改变该样式后，所有继承于该样式的样式将全部得到相应的更新。所以，除非某一样式及其子样式具有稳定不变的风格要求时，才能使用自动更新选项以保证该样式自身和继承于它的所有样式得到同步更新。若非如此，则慎用此选项。例如，一个典型的情况便是：若将Text（即正文）这种最普通的样式设成了自动更新，则在你写某一段文字时，突然想将其变成item list（编号列表）样式，然后你点击了item list按钮，随后就会发现文档中所有Text段落均给编上号码了。这就是由于你点了item list按钮，则相当于继承Text样式新生成了一个Text + item list样式，接着就是全文的自动更新...后果很严重!</p>

<h1 id="公式图表的编号与引用">公式、图、表的编号与引用</h1>

<p>图、表的自动编号与引用是很方便的，直接在Microsoft Word中插入”题注”或选择交叉引用则可以搞定。公式的编号也可以用Word来做，但是在引用公式时，即需要得到”如式(*.*)”所示的效果，则不能再使用Word的交叉引用功能了：在插入公式的引用后，Word会将公式对象本身与公式编号一齐插入到引用公式的地方。即使将插入的多余的公式对象删除也没有用：因为如果更新文档中的域，则在引用处又会重新出现公式对象。当然，如果你安装了MathType，则公式的引用就不存在上述问题。但这里给出一个我自己的解决方法，该方法采用VBA宏来实现”域代码”的自动写入，从而可以自动生成公式的编号与对公式的引用。</p>

<h2 id="公式自动编号">公式自动编号</h2>

<p>公式或者图、表的自动编号可以完全通过写入域代码来实现，而无需采用插入”题注”的方式。如果要生成形如”(4.13)”的编号（其中4为章号，13表示第4章内的第13个公式），其实就相当于有一个计数器，每生成一个公式或图、表对象，该计数器的值就加1；若遇到新的一章，则该记数器清零。将该计数器的值与章号结合，就可以得到形如”(4.13)”的公式编号。写成域代码如下：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>styleref 1 \s \*mergeformat
seq counter \* arabic \s 1 \*mergeformat
</code></pre></div></div>

<p>其中，<code class="language-plaintext highlighter-rouge">styleref 1 \s \*mergeformat</code>生成章号；<code class="language-plaintext highlighter-rouge">seq counter \* arabic \s 1 \*mergeformat</code>生成对象编号。<code class="language-plaintext highlighter-rouge">counter</code>是编号对象的计数器名称。例如，为了对公式、图、表分别自动编号，其计数器分别起名为：<code class="language-plaintext highlighter-rouge">eqn</code>, <code class="language-plaintext highlighter-rouge">fig</code>, <code class="language-plaintext highlighter-rouge">tab</code>。<code class="language-plaintext highlighter-rouge">\* arabic</code>表示以阿拉伯数字的方式显示自动编号。</p>

<p>为了引用某公式或图、表，则需要先选中其编号，然后插入书签，并给它起一个书签名。然后，就可以用下面的域代码引用该书签，得到的效果就是在引用处插入公式或图、表的编号：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ref bookmark_name \h
</code></pre></div></div>

<p>域代码的手动插入可以通过Ctrl+F9来实现，但较为麻烦。于是，将上述对象自动编号、添加书签与引用书签的过程写成VBA宏：</p>

<p><code class="language-plaintext highlighter-rouge">label_object</code>：自动生成对象编号。其中会提示输入上述计数器<code class="language-plaintext highlighter-rouge">counter</code>的名字，这样可以实现对不同的对象分别自动编号。</p>

<p><code class="language-plaintext highlighter-rouge">add_bookmark</code>：在选中的对象编号处生成一个书签。其中会提示输入书签的名字。只有生成了书签，才可以在文档中引用该对象。</p>

<p><code class="language-plaintext highlighter-rouge">ref_object</code>：在引用处插入被引用对象的编号。其中会提示输入对象书签的名字。对象编号处书签名字的查看，可以直接用快捷键<code class="language-plaintext highlighter-rouge">Ctrl+F5</code>。</p>

<h1 id="公式图片表格的排版">公式、图片、表格的排版</h1>

<h2 id="公式的排版">公式的排版</h2>

<p>论文中的公式格式通常是这样的：公式对象在文档正中居中放置，而公式编号在文档最右侧右对齐。这个样式并不是我们通常所用的”左、中、右对齐”或”两端对齐”。有不少人的处理方法是生成一个一行三列表格。中间的一个单元设置为居中对齐，其中插入公式对象；右边的单元格设置为右对齐，且单元的cell padding距离应设为零，其中写入公式的编号。这样的做法颇为麻烦。其实，只需要采用制表位就可以很容易实现公式与编号的对齐。为此，需专门为公式新建一个样式。其中的段落间距等等则按照常规来设置，除此之外，需要在文档的正中央设置一个对齐属性为”居中”的制表位，在版芯最右侧位置处设置一个右对齐的制表位。这样，在插入公式前，首先将其所在段落设为上述新建的样式。然后，按一次TAB键，就可以看到光标移到了文档的正中央，此时输入公式对象，则它以文档中央为基准居中对齐。接下来，再按一次TAB键，光标便移动至文档的最右端，此时运行<code class="language-plaintext highlighter-rouge">label_object</code>宏插入公式编号，该编号自动以文档最右端为基准右对齐。</p>

<h2 id="图片的排版">图片的排版</h2>

<p>图片的格式通常就是一行放置一个或一行并排放置两个图片。表格就只有一行放置一个的情况。对于一行放置一个对象的排版，只需新建一个”居中”的段落样式即可。对于一行并排放置两个图片的情况，则可以采用类似上述公式排版的方法，利用制表位来实现。我们可以新建一个名为”双图片”的样式，在版芯宽度的大约1/4与3/4处分别设置”居中”对齐的制表位。然后，通过按TAB键，则可以很快将光标移动至相应位置，然后在该处插入图片即可。</p>

<p>为了使全文图片的大小基本保持一致：例如，对于一行放置一个图片的情况，可以设置图片的宽度为版芯宽度的80%，为了保持图片原比例，图片的高度自动按比例缩放。对于一行放置两个图片的情况，可以设置图片宽度为版芯宽度的49%，图片高度按比例自动缩放。上述的调整过程写成宏<code class="language-plaintext highlighter-rouge">SetFig</code>与<code class="language-plaintext highlighter-rouge">SetTwoFig</code>。它们分别用来设置一行一个图片与一行两个图片格式下图片的宽度与高度。</p>

<h2 id="表格的排版">表格的排版</h2>

<p>正规文献中的表格均为三线表。然而，用Word自动插入的表格都是完整的横竖线，之后只能通过手动去调整表格与单元格的边框，颇为麻烦。为此，写了一个宏<code class="language-plaintext highlighter-rouge">Set3LineTable</code>，只要将表格选中，运行该宏，就可以将其设置为三线表了，而且线的粗细都是符合我们学校论文的要求。</p>

<h1 id="excel-chart的处理">Excel chart的处理</h1>

<p>平时很多的实验数据和由这些数据绘制出图表如何保存？用Matlab画出图导出成jpeg贴到word中？这应该是最要不得的做法：首先，大多数人图省事，随手贴入的都是彩色图。但毕业论文与发表的文章中一般均要使用黑白图片。更何况，绘出的图中坐标标注的字体、曲线线型等等一般都不合要求。将这些图存为jpeg，基本上就是在做无用功，等到写文章的时候，还得重新画的。如果重新的画的话，那当时用于绘图的程序都在哪儿？算例都在哪儿？这简直就是坠入了地狱。</p>

<p>用matlab绘图但将其存为<code class="language-plaintext highlighter-rouge">.fig</code>文件？看起来这是一个不错的方法。因为存成<code class="language-plaintext highlighter-rouge">.fig</code>文件时，图片和原数据都在（将其中曲线对应的数据取出还是有办法的，这里不再赘述）。但是，这毕竟还是有些麻烦，而且不太直观，无法直接看到与曲线对应的数据。</p>

<p>所以，这里还是推荐采用Excel来同时保存数据和根据这些数据画出的chart，这是一种非常直观和便捷的方式。虽然Excel并不是专门用来搞科研的工具软件，但是其功能还是够用的。如果不够你用，那么再去写一些VBA宏，就完全可以为所欲为。然而，在Excel中插入的chart通常都带有背景色，线型和marker也都跟我们学术绘图中常用的形式与符号大不相同，看起来极其古怪。所以，需要对chart中的各个元素属性进行修改，换成我们习惯的线型与marker（类似于Matlab中的线型与marker symbol就ok），将其设为黑白色。但这是一件非常让人吐血的麻烦事。所以，我也写了一个<code class="language-plaintext highlighter-rouge">SetChartStyle</code>宏，用于设置线型、marker symbol和大小，坐标系中的网格等。同时宏<code class="language-plaintext highlighter-rouge">SetTickNumberFormat</code>用于设置坐标轴数字标注的格式。这样一来，繁琐的事情在不到一秒中的时间就可以全部完成了，剩下的就只是微调一下chart的大小，然后就可以出炉了。</p>

<h1 id="参考文献的编排">参考文献的编排</h1>

<p>首先要说的一点是，传统的手工一条一条输入文献记录的方式一去不复返了。现在很多的参考文献管理软件不只是可以当作文献数据库和笔记本来用，而且已有不少可以直接与Word结合，在文档中自动插入文献条目和引用编号。商业的软件就不说了，（即使你有钱）想必也没有谁愿意去为其掏腰包。这里推荐大家使用基于Firefox浏览器的Zotero文献管理平台。因为与该软件配合使用的有一个Word插件，可以自动按不同杂志社要求的格式插入文献，并在文章中插入文献的引用编号。是否好用我没有尝试，大家可以试用一下。当然，Jabref也是一个很好的文献管理软件，目前已有基于OpenOffice的插件。上述两个软件均具有很好的移植性，可以在Windows, Linux, Mac下使用。</p>

<p>我此次博士论文对参考文献的插入与处理没有基于上述插件，因为感觉自己做起来可能会更可靠、稳妥些。我采用的方案是：将参考文献记录以”编号列表”的格式插入到文档的末尾。然后，在需要引用文献的地方，利用Word自己的插入列表项”题注”功能，则可以将与文献记录对应的编号插入到当前文本中。然而，这个做法并不能保证参考文献记录按我们引用的顺序排列，所以在经过对论文多次的修改后，参考文献记录的先后顺序可能是一团乱麻。为此，我写了<code class="language-plaintext highlighter-rouge">ListCitationNumbers</code>宏，它可以从文档开头至末尾搜索形如<code class="language-plaintext highlighter-rouge">[num]</code>的字符串，并将其中的数字编号<code class="language-plaintext highlighter-rouge">num</code>取出记录。如果某一编号在前文已出现过，那么再次遇到该编号时就不再记录，即每个文献引用编号只记录一次。搜索过程结束后，VBA宏就将这些引用的文献编号依次输出显示，根据这个数字序列我们就可以看到哪些文献记录的引用顺序有问题。然后，手动调整文档末尾参考文献记录的顺序并更新全文档中的域就可以了。此次论文排版过程中，我就是用这个宏来帮助自己调整参考文献的引用顺序的，完全可用、可靠，根本不需再像以前那样用肉眼从头到尾地挨个去看、去核对，非常方便省心。</p>

<h1 id="mathtype的使用">MathType的使用</h1>

<h2 id="mathtype-6与公式的快速输入">MathType 6与公式的快速输入</h2>

<p>这里推荐大家使用最新版的MathType 6，因为其中加入了对LaTeX的支持：即，你可以使用LaTeX的语法来输入公式符号。当然这并不是要你去学习全套的LaTeX技术，你只需要记住常用的几个LaTeX数学公式命令即可。而且，这些命令通常都是很好记的，只要你知道相应的数学符号的英文单词，对应的LaTeX命令就与它差不多。</p>

<p>当然，MathType本身也有快捷键来输入一部分公式符号。例如：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Ctrl+h: superscript
Ctrl+l: subscript
Ctrl+j: both super and sub scripts
Ctrl+f: fraction
Ctrl+i: integration symbol
Ctrl+k,d: partial differentiation
Ctrl+g, a\~z: greek letters
</code></pre></div></div>

<p>将上述MathType快捷键与LaTeX命令相结合，便可以实现基本上无需鼠标点击就能很高效地在Word中插入数学公式。</p>

<h2 id="mathtype的中文输入">MathType的中文输入</h2>

<p>常会遇见这样的情况，在公式编辑器中输入好中文后，再退出回到Word发现中文根本无法显示。解决方法如下：</p>

<p>在MathType中选择”样式”、”定义”，出现”定义风格”对话框，选择其中的”高级”单选按钮，出现样式列表，在”全角文字”的下拉列表框中，将”宋体-方正超大字符集”改为”宋体”。这时虽然列表框中还是显示”宋体-方正超大字符集”，但是此时再编辑公式时已经可以显示所输入的汉字了。例如，不会将”中国”只显示”中”字。每当不能显示所有汉字时你都如法炮制，就可以解决问题了。</p>

<h1 id="结语">结语</h1>

<p>以上介绍了Word排版中的一些小技巧，其中主要是通过VBA宏来实现的。对于排版中的常见问题如”含有公式的正文段落采用固定行距”、”分节实现不同的页眉与页脚”、”目录样式的修改”等则不再赘述。在Word排版方面，侯捷先生的《Word排版艺术》是相当好的书，大家可以参考。</p>

<p>下面附录中的代码则为本文正文中提到的VBA宏，大家需将其导入到Word文档中才能使用。而与Excel chart处理相关的宏则需要导入到Excel文件中。由于这些Word宏只是给自己排版使用的，所以最好将它们导入到自己的<code class="language-plaintext highlighter-rouge">Normal.dot</code>主模板文件中，而不要直接嵌入到你正在撰写的文档中。否则，当别人打开你的文档看到”该文档存在宏”的提示时，他就会怀疑你的文档有宏病毒而直接将其关掉。</p>

<h1 id="附录1-word-vba-macros">附录1 Word VBA macros</h1>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Function</span> <span class="nf">GetCiteKey</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">startChar</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                    <span class="k">ByVal</span> <span class="n">endChar</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                    <span class="k">ByRef</span> <span class="n">keys</span> <span class="ow">As</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">_</span>
                    <span class="k">ByRef</span> <span class="n">keyStart</span> <span class="ow">As</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">_</span>
                    <span class="k">ByRef</span> <span class="n">keyEnd</span> <span class="ow">As</span> <span class="n">Collection</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
                    
    <span class="k">Dim</span> <span class="nv">isfound</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="n">isfound</span> <span class="o">=</span> <span class="k">True</span>
    
    <span class="n">Selection</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="n">ClearFormatting</span>
    <span class="k">With</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Find</span>
        <span class="p">.</span><span class="n">Text</span> <span class="o">=</span> <span class="n">startChar</span>
        <span class="p">.</span><span class="n">Forward</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">Wrap</span> <span class="o">=</span> <span class="n">wdFindStop</span>
        <span class="p">.</span><span class="n">Format</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">End</span> <span class="k">With</span>
    <span class="k">Do</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">Find</span><span class="p">.</span><span class="n">Execute</span>
    <span class="k">If</span> <span class="n">StrComp</span><span class="p">(</span><span class="n">Selection</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">startChar</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="n">Selection</span><span class="p">.</span><span class="n">MoveStart</span> <span class="n">Unit</span><span class="p">:</span><span class="o">=</span><span class="n">wdCharacter</span><span class="p">,</span> <span class="n">Count</span><span class="p">:</span><span class="o">=</span><span class="mi">1</span>
        <span class="n">Selection</span><span class="p">.</span><span class="n">MoveEndUntil</span> <span class="n">cset</span><span class="p">:</span><span class="o">=</span><span class="n">endChar</span><span class="p">,</span> <span class="n">Count</span><span class="p">:</span><span class="o">=</span><span class="n">wdForward</span>
        <span class="k">If</span> <span class="n">ExistInCollection</span><span class="p">(</span><span class="n">Selection</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span> <span class="k">Then</span>
        <span class="k">Else</span>
            <span class="n">keys</span><span class="p">.</span><span class="n">Add</span> <span class="p">(</span><span class="n">Selection</span><span class="p">.</span><span class="n">Text</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">Selection</span><span class="p">.</span><span class="n">MoveRight</span> <span class="n">Unit</span><span class="p">:</span><span class="o">=</span><span class="n">wdCharacter</span><span class="p">,</span> <span class="n">Count</span><span class="p">:</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">Else</span>
        <span class="n">isfound</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">End</span> <span class="k">If</span>
    <span class="k">Loop</span> <span class="k">While</span> <span class="n">isfound</span>
    
    <span class="k">If</span> <span class="n">keys</span><span class="p">.</span><span class="n">Count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="n">GetCiteKey</span> <span class="o">=</span> <span class="k">True</span>
    <span class="k">Else</span>
        <span class="n">GetCiteKey</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Sub</span> <span class="nf">ListCitationNumbers</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">is_update</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">is_update</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Update the fields?"</span><span class="p">,</span> <span class="s">"Update the fields?"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">If</span> <span class="p">(</span><span class="n">is_update</span> <span class="o">=</span> <span class="s">"1"</span><span class="p">)</span> <span class="k">Then</span>
        <span class="k">Call</span> <span class="n">UpdateAllFields</span>
    <span class="k">End</span> <span class="k">If</span>
    
    <span class="c1">' list citations numbers without duplication</span>

    <span class="k">Dim</span> <span class="nv">keys</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Collection</span>
    <span class="k">Dim</span> <span class="nv">keyStart</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Collection</span>
    <span class="k">Dim</span> <span class="nv">keyEnd</span> <span class="ow">As</span> <span class="k">New</span> <span class="n">Collection</span>
    <span class="k">Dim</span> <span class="nv">isfound</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="k">Dim</span> <span class="nv">citeDict</span> <span class="ow">As</span> <span class="kt">Variant</span>
    
    <span class="n">isfound</span> <span class="o">=</span> <span class="n">GetCiteKey</span><span class="p">(</span><span class="s">"["</span><span class="p">,</span> <span class="s">"]"</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">keyStart</span><span class="p">,</span> <span class="n">keyEnd</span><span class="p">)</span>
    
    <span class="k">If</span> <span class="n">isfound</span> <span class="k">Then</span>
        <span class="n">MsgBox</span> <span class="p">(</span><span class="n">CombineKeys</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="s">", "</span><span class="p">))</span>
    <span class="k">Else</span>
        <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"No citations!"</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Function</span> <span class="nf">CombineKeys</span><span class="p">(</span><span class="k">ByRef</span> <span class="n">keys</span> <span class="ow">As</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">_</span>
                     <span class="k">ByVal</span> <span class="n">delimiter</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">Dim</span> <span class="nv">str</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">keys</span><span class="p">.</span><span class="n">Count</span>
        <span class="k">If</span> <span class="n">i</span> <span class="o">=</span> <span class="n">keys</span><span class="p">.</span><span class="n">Count</span> <span class="k">Then</span>
            <span class="n">str</span> <span class="o">=</span> <span class="n">str</span> <span class="o">&amp;</span> <span class="n">keys</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">Else</span>
            <span class="n">str</span> <span class="o">=</span> <span class="n">str</span> <span class="o">&amp;</span> <span class="n">keys</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">delimiter</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">Next</span> <span class="n">i</span>
    <span class="n">CombineKeys</span> <span class="o">=</span> <span class="n">str</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Function</span> <span class="nf">ExistInCollection</span><span class="p">(</span><span class="n">item</span> <span class="ow">As</span> <span class="kt">String</span><span class="p">,</span> <span class="n">_</span>
                           <span class="n">list</span> <span class="ow">As</span> <span class="n">Collection</span><span class="p">)</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="k">Dim</span> <span class="nv">flag</span> <span class="ow">As</span> <span class="kt">Boolean</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
    
    <span class="n">flag</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">list</span><span class="p">.</span><span class="n">Count</span>
        <span class="k">If</span> <span class="n">StrComp</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">list</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span>
            <span class="n">flag</span> <span class="o">=</span> <span class="k">True</span>
            <span class="k">Exit</span> <span class="k">For</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">Next</span> <span class="n">i</span>
    
    <span class="n">ExistInCollection</span> <span class="o">=</span> <span class="n">flag</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Sub</span> <span class="nf">ShowFields</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Count</span>
        <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">ShowCodes</span> <span class="o">=</span> <span class="k">True</span>
    <span class="k">Next</span> <span class="n">i</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">HideFields</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Count</span>
        <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">ShowCodes</span> <span class="o">=</span> <span class="k">False</span>
    <span class="k">Next</span> <span class="n">i</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">UpdateAllFields</span><span class="p">()</span>
    <span class="c1">'更新全文档的域</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Count</span>
        <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Update</span>
    <span class="k">Next</span> <span class="n">i</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">UpdateSecFields</span><span class="p">()</span>
    <span class="c1">'更新当前节的域</span>
    <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
    <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Sections</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Range</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Count</span>
        <span class="n">Selection</span><span class="p">.</span><span class="n">Sections</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Range</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Update</span>
    <span class="k">Next</span> <span class="n">i</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">label_object</span><span class="p">()</span>
    <span class="c1">' automatically insert numbers for equation, figure and table, or anything else</span>
    <span class="k">Dim</span> <span class="nv">labelType</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="c1">' three label types are supported: equation, figure, and table</span>
    <span class="n">labelType</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Label type: "</span><span class="p">,</span> <span class="n">_</span>
                         <span class="s">"eqn? fig? tab?"</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">StrComp</span><span class="p">(</span><span class="n">labelType</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="k">If</span> <span class="n">StrComp</span><span class="p">(</span><span class="n">labelType</span><span class="p">,</span> <span class="s">"eqn"</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span>
            <span class="n">Selection</span><span class="p">.</span><span class="n">TypeText</span> <span class="n">Text</span><span class="p">:</span><span class="o">=</span><span class="s">"("</span>
        <span class="k">End</span> <span class="k">If</span>
      
        <span class="n">Selection</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Add</span> <span class="n">Range</span><span class="p">:</span><span class="o">=</span><span class="n">Selection</span><span class="p">.</span><span class="n">Range</span><span class="p">,</span> <span class="n">_</span>
                 <span class="n">Type</span><span class="p">:</span><span class="o">=</span><span class="n">wdFieldEmpty</span><span class="p">,</span> <span class="n">_</span>
                 <span class="n">Text</span><span class="p">:</span><span class="o">=</span><span class="s">"styleref 1 \s \*mergeformat"</span><span class="p">,</span> <span class="n">_</span>
                 <span class="n">preserveformatting</span><span class="p">:</span><span class="o">=</span><span class="k">False</span>
        <span class="n">Selection</span><span class="p">.</span><span class="n">TypeText</span> <span class="n">Text</span><span class="p">:</span><span class="o">=</span><span class="s">"."</span>
        <span class="n">Selection</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Add</span> <span class="n">Range</span><span class="p">:</span><span class="o">=</span><span class="n">Selection</span><span class="p">.</span><span class="n">Range</span><span class="p">,</span> <span class="n">_</span>
                 <span class="n">Type</span><span class="p">:</span><span class="o">=</span><span class="n">wdFieldEmpty</span><span class="p">,</span> <span class="n">_</span>
                 <span class="n">Text</span><span class="p">:</span><span class="o">=</span><span class="s">"seq "</span> <span class="o">+</span> <span class="n">labelType</span> <span class="o">+</span> <span class="s">" \* arabic \s 1 \*mergeformat"</span><span class="p">,</span> <span class="n">_</span>
                 <span class="n">preserveformatting</span><span class="p">:</span><span class="o">=</span><span class="k">False</span>
        <span class="k">If</span> <span class="n">StrComp</span><span class="p">(</span><span class="n">labelType</span><span class="p">,</span> <span class="s">"eqn"</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">Then</span>
            <span class="n">Selection</span><span class="p">.</span><span class="n">TypeText</span> <span class="n">Text</span><span class="p">:</span><span class="o">=</span><span class="s">")"</span>
        <span class="k">End</span> <span class="k">If</span>
        <span class="n">Selection</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Update</span>
    <span class="k">Else</span>
        <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Nothing is done!"</span><span class="p">)</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">add_bookmark</span><span class="p">()</span>
    <span class="c1">' add bookmark to selected range</span>
    <span class="k">Dim</span> <span class="nv">bookmark</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">bookmark</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Bookmark: "</span><span class="p">,</span> <span class="s">"Enter a bookmark name"</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">StrComp</span><span class="p">(</span><span class="n">bookmark</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="k">If</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Bookmarks</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">bookmark</span><span class="p">)</span> <span class="k">Then</span>
            <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"Bookmark you've entered already exists!"</span><span class="p">)</span>
        <span class="k">Else</span>
            <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Bookmarks</span><span class="p">.</span><span class="n">Add</span> <span class="n">bookmark</span><span class="p">,</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Range</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>


<span class="k">Sub</span> <span class="nf">ref_object</span><span class="p">()</span>
    <span class="c1">' insert a reference to an existing bookmark</span>
    <span class="k">Dim</span> <span class="nv">bookmark</span> <span class="ow">As</span> <span class="kt">String</span>
    <span class="n">bookmark</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Bookmark: "</span><span class="p">,</span> <span class="s">"Enter a bookmark to be referenced"</span><span class="p">)</span>
    <span class="k">If</span> <span class="n">StrComp</span><span class="p">(</span><span class="n">bookmark</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="k">Then</span>
        <span class="k">If</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Bookmarks</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">bookmark</span><span class="p">)</span> <span class="k">Then</span>
            <span class="n">Selection</span><span class="p">.</span><span class="n">Fields</span><span class="p">.</span><span class="n">Add</span> <span class="n">Range</span><span class="p">:</span><span class="o">=</span><span class="n">Selection</span><span class="p">.</span><span class="n">Range</span><span class="p">,</span> <span class="n">_</span>
                     <span class="n">Type</span><span class="p">:</span><span class="o">=</span><span class="n">wdFieldEmpty</span><span class="p">,</span> <span class="n">_</span>
                     <span class="n">Text</span><span class="p">:</span><span class="o">=</span><span class="s">"ref "</span> <span class="o">+</span> <span class="n">bookmark</span> <span class="o">+</span> <span class="s">" \h"</span><span class="p">,</span> <span class="n">_</span>
                     <span class="n">preserveformatting</span><span class="p">:</span><span class="o">=</span><span class="k">False</span>
        <span class="k">Else</span>
            <span class="n">MsgBox</span> <span class="p">(</span><span class="s">"The bookmark you've entered does not exist!"</span><span class="p">)</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetDotLeader</span><span class="p">()</span>
    <span class="k">For</span> <span class="k">Each</span> <span class="n">toc</span> <span class="ow">In</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">TablesOfContents</span>
        <span class="n">toc</span><span class="p">.</span><span class="n">TabLeader</span> <span class="o">=</span> <span class="n">wdTabLeaderDots</span>
    <span class="k">Next</span> <span class="n">toc</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">ListAllStyles</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">aStyle</span> <span class="ow">As</span> <span class="n">Style</span>
    <span class="k">For</span> <span class="k">Each</span> <span class="n">aStyle</span> <span class="ow">In</span> <span class="n">ActiveDocument</span><span class="p">.</span><span class="n">Styles</span>
        <span class="k">If</span> <span class="p">(</span><span class="n">aStyle</span><span class="p">.</span><span class="n">InUse</span> <span class="o">=</span> <span class="k">True</span><span class="p">)</span> <span class="k">Then</span>
            <span class="n">MsgBox</span> <span class="n">aStyle</span><span class="p">.</span><span class="n">NameLocal</span>
        <span class="k">End</span> <span class="k">If</span>
    <span class="k">Next</span> <span class="n">aStyle</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetRefStyle</span><span class="p">()</span>
    <span class="c1">'设置参考文献条目的格式</span>
    <span class="k">With</span> <span class="n">Selection</span><span class="p">.</span><span class="n">ParagraphFormat</span>
        <span class="p">.</span><span class="n">LeftIndent</span> <span class="o">=</span> <span class="n">MillimetersToPoints</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">.</span><span class="n">RightIndent</span> <span class="o">=</span> <span class="n">MillimetersToPoints</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="p">.</span><span class="n">SpaceBefore</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="p">.</span><span class="n">SpaceBeforeAuto</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">SpaceAfter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">.</span><span class="n">SpaceAfterAuto</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">LineSpacingRule</span> <span class="o">=</span> <span class="n">wdLineSpaceExactly</span>
        <span class="p">.</span><span class="n">LineSpacing</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="p">.</span><span class="n">Alignment</span> <span class="o">=</span> <span class="n">wdAlignParagraphJustify</span>
        <span class="p">.</span><span class="n">WidowControl</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">KeepWithNext</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">KeepTogether</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">PageBreakBefore</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">NoLineNumber</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Hyphenation</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">FirstLineIndent</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="p">.</span><span class="n">OutlineLevel</span> <span class="o">=</span> <span class="n">wdOutlineLevelBodyText</span>
        <span class="p">.</span><span class="n">CharacterUnitLeftIndent</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">.</span><span class="n">CharacterUnitRightIndent</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">.</span><span class="n">CharacterUnitFirstLineIndent</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="p">.</span><span class="n">LineUnitBefore</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">.</span><span class="n">LineUnitAfter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">.</span><span class="n">AutoAdjustRightIndent</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">DisableLineHeightGrid</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">FarEastLineBreakControl</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">WordWrap</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">HangingPunctuation</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">HalfWidthPunctuationOnTopOfLine</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">AddSpaceBetweenFarEastAndAlpha</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">AddSpaceBetweenFarEastAndDigit</span> <span class="o">=</span> <span class="k">True</span>
        <span class="p">.</span><span class="n">BaseLineAlignment</span> <span class="o">=</span> <span class="n">wdBaselineAlignAuto</span>
    <span class="k">End</span> <span class="k">With</span>
    <span class="k">With</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Font</span>
        <span class="p">.</span><span class="n">NameFarEast</span> <span class="o">=</span> <span class="s">"宋体"</span>
        <span class="p">.</span><span class="n">NameAscii</span> <span class="o">=</span> <span class="s">"Times New Roman"</span>
        <span class="p">.</span><span class="n">NameOther</span> <span class="o">=</span> <span class="s">"Times New Roman"</span>
        <span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">"Times New Roman"</span>
        <span class="p">.</span><span class="n">Size</span> <span class="o">=</span> <span class="mf">10.5</span>
        <span class="p">.</span><span class="n">Bold</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Italic</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Underline</span> <span class="o">=</span> <span class="n">wdUnderlineNone</span>
        <span class="p">.</span><span class="n">UnderlineColor</span> <span class="o">=</span> <span class="n">wdColorAutomatic</span>
        <span class="p">.</span><span class="n">StrikeThrough</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">DoubleStrikeThrough</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Outline</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Emboss</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Shadow</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Hidden</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">SmallCaps</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">AllCaps</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">wdColorAutomatic</span>
        <span class="p">.</span><span class="n">Engrave</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Superscript</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Subscript</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">Spacing</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">.</span><span class="n">Scaling</span> <span class="o">=</span> <span class="mi">100</span>
        <span class="p">.</span><span class="n">Position</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="p">.</span><span class="n">Kerning</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="p">.</span><span class="n">Animation</span> <span class="o">=</span> <span class="n">wdAnimationNone</span>
        <span class="p">.</span><span class="n">DisableCharacterSpaceGrid</span> <span class="o">=</span> <span class="k">False</span>
        <span class="p">.</span><span class="n">EmphasisMark</span> <span class="o">=</span> <span class="n">wdEmphasisMarkNone</span>
    <span class="k">End</span> <span class="k">With</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Function</span> <span class="nf">TextWidth</span><span class="p">()</span>
    <span class="c1">'获取版心的宽度</span>
    <span class="k">With</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Sections</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">TextWidth</span> <span class="o">=</span> <span class="p">.</span><span class="n">PageSetup</span><span class="p">.</span><span class="n">PageWidth</span> <span class="o">-</span> <span class="p">.</span><span class="n">PageSetup</span><span class="p">.</span><span class="n">LeftMargin</span> <span class="o">-</span> <span class="p">.</span><span class="n">PageSetup</span><span class="p">.</span><span class="n">RightMargin</span>
    <span class="k">End</span> <span class="k">With</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Function</span> <span class="nf">TextHeight</span><span class="p">()</span>
    <span class="c1">'获取版心的高度</span>
    <span class="k">With</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Sections</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">TextHeight</span> <span class="o">=</span> <span class="p">.</span><span class="n">PageSetup</span><span class="p">.</span><span class="n">PageHeight</span> <span class="o">-</span> <span class="p">.</span><span class="n">PageSetup</span><span class="p">.</span><span class="n">TopMargin</span> <span class="o">-</span> <span class="p">.</span><span class="n">PageSetup</span><span class="p">.</span><span class="n">BottomMargin</span>
    <span class="k">End</span> <span class="k">With</span>
<span class="k">End</span> <span class="k">Function</span>

<span class="k">Sub</span> <span class="nf">SetFig</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">ratio</span> <span class="ow">As</span> <span class="kt">Double</span>
    <span class="c1">' 设置图片的属性：单张图片的宽度为版心宽度的 0.8，高度则自动按比例调整</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">TextWidth</span> <span class="o">*</span> <span class="mf">0.8</span> <span class="o">/</span> <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Width</span>
    
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">LockAspectRatio</span> <span class="o">=</span> <span class="n">msoTrue</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Width</span> <span class="o">=</span> <span class="n">TextWidth</span> <span class="o">*</span> <span class="mf">0.8</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Height</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Height</span> <span class="o">*</span> <span class="n">ratio</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">PictureFormat</span><span class="p">.</span><span class="n">Brightness</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">PictureFormat</span><span class="p">.</span><span class="n">Contrast</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetTwoFig</span><span class="p">()</span>
    <span class="k">Dim</span> <span class="nv">ratio</span> <span class="ow">As</span> <span class="kt">Double</span>
    <span class="c1">' 设置图片的属性：单张图片的宽度为版心宽度的 0.8，高度则自动按比例调整</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="n">TextWidth</span> <span class="o">*</span> <span class="mf">0.49</span> <span class="o">/</span> <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Width</span>
    
    <span class="c1">'设置两个并排图片的宽度</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">LockAspectRatio</span> <span class="o">=</span> <span class="n">msoTrue</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Width</span> <span class="o">=</span> <span class="n">TextWidth</span> <span class="o">*</span> <span class="mf">0.49</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Height</span> <span class="o">=</span> <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">Height</span> <span class="o">*</span> <span class="n">ratio</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">PictureFormat</span><span class="p">.</span><span class="n">Brightness</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">Selection</span><span class="p">.</span><span class="n">InlineShapes</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">PictureFormat</span><span class="p">.</span><span class="n">Contrast</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">Set3LineTable</span><span class="p">()</span>
    <span class="k">With</span> <span class="n">Selection</span><span class="p">.</span><span class="n">Tables</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1">'''''''''''''''''''</span>
        <span class="c1">'设置外框，除去内框</span>
        <span class="c1">'''''''''''''''''''</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderHorizontal</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">wdLineStyleNone</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderVertical</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">wdLineStyleNone</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderLeft</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">wdLineStyleNone</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderRight</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">wdLineStyleNone</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderBottom</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">wdLineStyleSingle</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderTop</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">wdLineStyleSingle</span>
        <span class="c1">' 注意：这里150pt即为1.5磅</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderBottom</span><span class="p">).</span><span class="n">LineWidth</span> <span class="o">=</span> <span class="n">wdLineWidth150pt</span>
        <span class="p">.</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderTop</span><span class="p">).</span><span class="n">LineWidth</span> <span class="o">=</span> <span class="n">wdLineWidth150pt</span>
        
        <span class="c1">'设置第一行单元线：宽度1磅</span>
        <span class="p">.</span><span class="n">Rows</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderTop</span><span class="p">).</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">wdLineStyleSingle</span>
        <span class="p">.</span><span class="n">Rows</span><span class="p">(</span><span class="mi">2</span><span class="p">).</span><span class="n">Borders</span><span class="p">(</span><span class="n">wdBorderTop</span><span class="p">).</span><span class="n">LineWidth</span> <span class="o">=</span> <span class="n">wdLineWidth100pt</span>
    <span class="k">End</span> <span class="k">With</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>

<h1 id="附录2--excel-vba-macros">附录2  Excel VBA macros</h1>

<div class="language-vb highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">Sub</span> <span class="nf">SetTickNumberFormat</span><span class="p">()</span>
   <span class="k">Dim</span> <span class="nv">x_format</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">y_format</span> <span class="ow">As</span> <span class="kt">String</span>
  
   <span class="n">x_format</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"X format"</span><span class="p">,</span> <span class="s">"X format"</span><span class="p">,</span> <span class="s">"General"</span><span class="p">)</span>
   <span class="n">y_format</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Y format"</span><span class="p">,</span> <span class="s">"Y format"</span><span class="p">,</span> <span class="s">"General"</span><span class="p">)</span>
  
   <span class="k">If</span> <span class="p">(</span><span class="n">x_format</span> <span class="o">&lt;&gt;</span> <span class="s">""</span><span class="p">)</span> <span class="k">Then</span>
       <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlCategory</span><span class="p">).</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">NumberFormat</span> <span class="o">=</span> <span class="n">x_format</span>
   <span class="k">End</span> <span class="k">If</span>
  
   <span class="k">If</span> <span class="p">(</span><span class="n">y_format</span> <span class="o">&lt;&gt;</span> <span class="s">""</span><span class="p">)</span> <span class="k">Then</span>
       <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlValue</span><span class="p">).</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">NumberFormat</span> <span class="o">=</span> <span class="n">y_format</span>
   <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetGrid</span><span class="p">()</span>
   <span class="k">Dim</span> <span class="nv">is_major_on</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="k">Dim</span> <span class="nv">is_minor_on</span> <span class="ow">As</span> <span class="kt">String</span>
  
   <span class="n">is_major_on</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Major grid On? Off?"</span><span class="p">,</span> <span class="s">"Major grid On? Off?"</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>
   <span class="n">is_minor_on</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Minor grid On? Off?"</span><span class="p">,</span> <span class="s">"Minor grid On? Off?"</span><span class="p">,</span> <span class="s">"0"</span><span class="p">)</span>
  
   <span class="k">If</span> <span class="p">(</span><span class="n">is_major_on</span> <span class="o">&lt;&gt;</span> <span class="s">""</span><span class="p">)</span> <span class="k">Then</span>
       <span class="k">If</span> <span class="p">(</span><span class="n">is_major_on</span> <span class="o">=</span> <span class="s">"1"</span><span class="p">)</span> <span class="k">Then</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlCategory</span><span class="p">).</span><span class="n">HasMajorGridlines</span> <span class="o">=</span> <span class="k">True</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlValue</span><span class="p">).</span><span class="n">HasMajorGridlines</span> <span class="o">=</span> <span class="k">True</span>
       <span class="k">Else</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlCategory</span><span class="p">).</span><span class="n">HasMajorGridlines</span> <span class="o">=</span> <span class="k">False</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlValue</span><span class="p">).</span><span class="n">HasMajorGridlines</span> <span class="o">=</span> <span class="k">False</span>
       <span class="k">End</span> <span class="k">If</span>
   <span class="k">End</span> <span class="k">If</span>
  
   <span class="k">If</span> <span class="p">(</span><span class="n">is_minor_on</span> <span class="o">&lt;&gt;</span> <span class="s">""</span><span class="p">)</span> <span class="k">Then</span>
       <span class="k">If</span> <span class="p">(</span><span class="n">is_minor_on</span> <span class="o">=</span> <span class="s">"1"</span><span class="p">)</span> <span class="k">Then</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlCategory</span><span class="p">).</span><span class="n">HasMinorGridlines</span> <span class="o">=</span> <span class="k">True</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlValue</span><span class="p">).</span><span class="n">HasMinorGridlines</span> <span class="o">=</span> <span class="k">True</span>
       <span class="k">Else</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlCategory</span><span class="p">).</span><span class="n">HasMinorGridlines</span> <span class="o">=</span> <span class="k">False</span>
           <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlValue</span><span class="p">).</span><span class="n">HasMinorGridlines</span> <span class="o">=</span> <span class="k">False</span>
       <span class="k">End</span> <span class="k">If</span>
   <span class="k">End</span> <span class="k">If</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetChartStyle</span><span class="p">()</span>
   <span class="c1">' config the total chart area</span>
   <span class="c1">' ChartArea的大小不能用程序设置，只能手动调整</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">ChartArea</span><span class="p">.</span><span class="n">AutoScaleFont</span> <span class="o">=</span> <span class="k">False</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">ChartArea</span><span class="p">.</span><span class="n">Border</span><span class="p">.</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">xlLineStyleNone</span>
  
   <span class="c1">' config the plot area</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">PlotArea</span><span class="p">.</span><span class="n">Border</span><span class="p">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">PlotArea</span><span class="p">.</span><span class="n">Border</span><span class="p">.</span><span class="n">Weight</span> <span class="o">=</span> <span class="n">xlThin</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">PlotArea</span><span class="p">.</span><span class="n">Interior</span><span class="p">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">PlotArea</span><span class="p">.</span><span class="n">Width</span> <span class="o">=</span> <span class="n">ActiveChart</span><span class="p">.</span><span class="n">ChartArea</span><span class="p">.</span><span class="n">Width</span> <span class="o">*</span> <span class="mf">0.9</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">PlotArea</span><span class="p">.</span><span class="n">Height</span> <span class="o">=</span> <span class="n">ActiveChart</span><span class="p">.</span><span class="n">ChartArea</span><span class="p">.</span><span class="n">Height</span> <span class="o">*</span> <span class="mf">0.9</span>
  
   <span class="c1">' config the axes</span>
   <span class="c1">' 注意：下面的标签格式化编码与单元格式化中自定义编码中的格式化字符串相同</span>
   <span class="k">With</span> <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlCategory</span><span class="p">)</span>
       <span class="c1">'remove the major grid lines</span>
       <span class="p">.</span><span class="n">HasMajorGridlines</span> <span class="o">=</span> <span class="k">False</span>
       <span class="p">.</span><span class="n">HasMinorGridlines</span> <span class="o">=</span> <span class="k">False</span>
       <span class="p">.</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">AutoScaleFont</span> <span class="o">=</span> <span class="k">False</span>
       <span class="p">.</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="o">=</span> <span class="mi">10</span>
       <span class="p">.</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">NumberFormat</span> <span class="o">=</span> <span class="s">"General"</span>
       <span class="p">.</span><span class="n">TickLabelPosition</span> <span class="o">=</span> <span class="n">xlTickLabelPositionNextToAxis</span>
       <span class="p">.</span><span class="n">Crosses</span> <span class="o">=</span> <span class="n">xlMinimum</span> <span class="c1">'默认是在最小值处相交</span>
    <span class="k">End</span> <span class="k">With</span>
  
   <span class="k">With</span> <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Axes</span><span class="p">(</span><span class="n">xlValue</span><span class="p">)</span>
       <span class="p">.</span><span class="n">HasMajorGridlines</span> <span class="o">=</span> <span class="k">False</span>
       <span class="p">.</span><span class="n">HasMinorGridlines</span> <span class="o">=</span> <span class="k">False</span>
       <span class="p">.</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">AutoScaleFont</span> <span class="o">=</span> <span class="k">False</span>
       <span class="p">.</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">NumberFormat</span> <span class="o">=</span> <span class="s">"General"</span>
       <span class="p">.</span><span class="n">TickLabels</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="o">=</span> <span class="mi">10</span>
       <span class="p">.</span><span class="n">Crosses</span> <span class="o">=</span> <span class="n">xlMinimum</span> <span class="c1">'默认是在最小值处相交</span>
    <span class="k">End</span> <span class="k">With</span>
  
   <span class="c1">' legend config</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Legend</span><span class="p">.</span><span class="n">AutoScaleFont</span> <span class="o">=</span> <span class="k">False</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Legend</span><span class="p">.</span><span class="n">Position</span> <span class="o">=</span> <span class="n">xlLegendPositionBottom</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Legend</span><span class="p">.</span><span class="n">Border</span><span class="p">.</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">xlLineStyleNone</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Legend</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">"宋体"</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">Legend</span><span class="p">.</span><span class="n">Font</span><span class="p">.</span><span class="n">Size</span> <span class="o">=</span> <span class="mi">12</span>
  
   <span class="c1">' config the line series</span>
   <span class="k">Dim</span> <span class="nv">i</span> <span class="ow">As</span> <span class="kt">Integer</span>
   <span class="k">Dim</span> <span class="nv">pltp</span> <span class="ow">As</span> <span class="kt">String</span>
   <span class="n">pltp</span> <span class="o">=</span> <span class="n">InputBox</span><span class="p">(</span><span class="s">"Line? Marker? Or both?"</span><span class="p">,</span> <span class="s">"Line? Marker? Or both?"</span><span class="p">,</span> <span class="s">"1"</span><span class="p">)</span>
   <span class="k">If</span> <span class="p">(</span><span class="n">pltp</span> <span class="o">&lt;&gt;</span> <span class="s">""</span><span class="p">)</span> <span class="k">Then</span>
       <span class="k">For</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">To</span> <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">.</span><span class="n">Count</span>
           <span class="k">Select</span> <span class="k">Case</span> <span class="p">(</span><span class="n">pltp</span><span class="p">)</span>
               <span class="k">Case</span> <span class="s">"1"</span>
                   <span class="n">SetLineStyle</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>    <span class="c1">'设置不同的线型：只有线没有marker</span>
                <span class="k">Case</span> <span class="s">"2"</span>
                   <span class="n">SetMarkerStyle</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1">'设置不同的marker: 只有marker 没有线</span>
                <span class="k">Case</span> <span class="s">"3"</span>
                   <span class="n">SetLineMarkerStyle</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="c1">'同时设置marker与线型</span>
            <span class="k">End</span> <span class="k">Select</span>
       <span class="k">Next</span> <span class="n">i</span>
   <span class="k">End</span> <span class="k">If</span>
  
   <span class="k">Call</span> <span class="n">SetGrid</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetLineStyle</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span>
   <span class="k">Dim</span> <span class="nv">ls_list</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="n">ls_list</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">xlContinuous</span><span class="p">,</span> <span class="n">xlDash</span><span class="p">,</span> <span class="n">xlDashDot</span><span class="p">,</span> <span class="n">xlDot</span><span class="p">,</span> <span class="n">xlDashDotDot</span><span class="p">)</span>
  
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerStyle</span> <span class="o">=</span> <span class="n">xlMarkerStyleNone</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Border</span><span class="p">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Border</span><span class="p">.</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">ls_list</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetMarkerStyle</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span>
   <span class="c1">' 这里的marker是空心的</span>
   <span class="k">Dim</span> <span class="nv">mk_list</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="n">mk_list</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">xlMarkerStyleSquare</span><span class="p">,</span> <span class="n">xlMarkerStyleDiamond</span><span class="p">,</span> <span class="n">xlMarkerStyleTriangle</span><span class="p">,</span> <span class="n">_</span>
                   <span class="n">xlMarkerStyleX</span><span class="p">,</span> <span class="n">xlMarkerStyleCircle</span><span class="p">)</span>
                  
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Border</span><span class="p">.</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">xlLineStyleNone</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerStyle</span> <span class="o">=</span> <span class="n">mk_list</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerSize</span> <span class="o">=</span> <span class="mi">5</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerBackgroundColor</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerForegroundColor</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>

<span class="k">Sub</span> <span class="nf">SetLineMarkerStyle</span><span class="p">(</span><span class="k">ByVal</span> <span class="n">i</span> <span class="ow">As</span> <span class="kt">Integer</span><span class="p">)</span>
   <span class="k">Dim</span> <span class="nv">ls_list</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="n">ls_list</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">xlContinuous</span><span class="p">,</span> <span class="n">xlDash</span><span class="p">,</span> <span class="n">xlDashDot</span><span class="p">,</span> <span class="n">xlDot</span><span class="p">,</span> <span class="n">xlDashDotDot</span><span class="p">)</span>
   <span class="c1">' 这里的marker是空心的</span>
   <span class="k">Dim</span> <span class="nv">mk_list</span> <span class="ow">As</span> <span class="kt">Variant</span>
   <span class="n">mk_list</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">xlMarkerStyleSquare</span><span class="p">,</span> <span class="n">xlMarkerStyleDiamond</span><span class="p">,</span> <span class="n">xlMarkerStyleTriangle</span><span class="p">,</span> <span class="n">_</span>
                   <span class="n">xlMarkerStyleX</span><span class="p">,</span> <span class="n">xlMarkerStyleCircle</span><span class="p">)</span>
                  
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Border</span><span class="p">.</span><span class="n">Color</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Border</span><span class="p">.</span><span class="n">LineStyle</span> <span class="o">=</span> <span class="n">ls_list</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerStyle</span> <span class="o">=</span> <span class="n">mk_list</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerSize</span> <span class="o">=</span> <span class="mi">5</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerBackgroundColor</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
   <span class="n">ActiveChart</span><span class="p">.</span><span class="n">SeriesCollection</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">MarkerForegroundColor</span> <span class="o">=</span> <span class="n">RGB</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>
</code></pre></div></div>


  </div><a class="u-url" href="/computer/2009/04/19/Microsoft-Office%E8%AE%BA%E6%96%87%E6%8E%92%E7%89%88%E6%8A%80%E5%B7%A7.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">止于至善</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Jihuan Tian</li><li><a class="u-email" href="mailto:jihuan_tian@hotmail.com">jihuan_tian@hotmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>As regards numerical analysis, mathematical electromagnetism, Linux techniques and personal thoughts.</p>
      </div>
      <div class="footer-col">
        <p>The articles are under a <a href='http://creativecommons.org/licenses/by-nc-sa/4.0/'>Creative Commons Attribution License</a>. Copyright &copy; 2024 <a href="mailto:jihuan_tian@hotmail.com">Jihuan Tian</a>.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
