<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Clipboards in X Window System | 止于至善</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Clipboards in X Window System" />
<meta name="author" content="Jihuan Tian" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="There are three types of clipboards in X Window System." />
<meta property="og:description" content="There are three types of clipboards in X Window System." />
<link rel="canonical" href="https://jihuan-tian.github.io/computer/2022/05/28/clipboards-in-X-Window-System.html" />
<meta property="og:url" content="https://jihuan-tian.github.io/computer/2022/05/28/clipboards-in-X-Window-System.html" />
<meta property="og:site_name" content="止于至善" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-05-28T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Clipboards in X Window System" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jihuan Tian"},"dateModified":"2022-05-28T00:00:00+08:00","datePublished":"2022-05-28T00:00:00+08:00","description":"There are three types of clipboards in X Window System.","headline":"Clipboards in X Window System","mainEntityOfPage":{"@type":"WebPage","@id":"https://jihuan-tian.github.io/computer/2022/05/28/clipboards-in-X-Window-System.html"},"url":"https://jihuan-tian.github.io/computer/2022/05/28/clipboards-in-X-Window-System.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/font.css">
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/htmlize-syntax-highlight.css">
  
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico?">
  <link href="https://fonts.googlefonts.cn/css?family=EB+Garamond" rel="stylesheet"><link type="application/atom+xml" rel="alternate" href="https://jihuan-tian.github.io/feed.xml" title="止于至善" />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">止于至善</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <!-- Enforce a fixed order for my categories. -->
          <a class="page-link" href="/math/">Math</a>
          <a class="page-link" href="/computer/">Computer</a>
          <a class="page-link" href="/thoughts/">Thoughts</a>
          <a class="page-link" href="/tags/">Tags</a>
          <a class="page-link" href="/about/">About</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Clipboards in X Window System</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2022-05-28T00:00:00+08:00" itemprop="datePublished">May 28, 2022 &nbsp;

        
          Categories:
          
            <a href="/computer">Computer</a>
          
         &nbsp;
        
          Tags:
          
            <a href="/tags/Bash">Bash</a>
          
            <a href="/tags/command">command</a>
          
            <a href="/tags/Linux">Linux</a>
          
            <a href="/tags/X-Window">X-Window</a>
          
            <a href="/tags/Emacs">Emacs</a>
          
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>There are three types of clipboards in X Window System.</p>

<ul>
  <li>
    <p>Primary selection</p>

    <p>It contains the last selection of text via mouse dragging in an X application. Clicking the middle mouse button will paste its contents elsewhere. This is a very convenient way for fast copying and pasting on Linux, since only mouse clicking is needed without bothering to press the <code class="language-plaintext highlighter-rouge">Ctrl+c/Ctrl+v</code> hotkeys.</p>
  </li>
  <li>
    <p>Secondary selection</p>

    <p>It is a counterpart of the primary selection, but most applications do not support it. Luckily, in Emacs we can use this function via mouse clicking similar to the operation for the primary selection, but with the <code class="language-plaintext highlighter-rouge">Meta</code> key pressed. When some text is selected in this way, Emacs will highlight it using a color different from that for a normal mouse selection, which is controlled by the face <code class="language-plaintext highlighter-rouge">secondary-selection</code>. By the way, the face for the primary selection in Emacs is <code class="language-plaintext highlighter-rouge">region</code>.</p>
  </li>
  <li>
    <p>Clipboard</p>

    <p>This is the classical clipboard manipulated via the <code class="language-plaintext highlighter-rouge">Ctrl+c/Ctrl+v</code> hotkeys, which we’ve been familiar with in most operating systems.</p>
  </li>
</ul>

<p>Linux provides the command <code class="language-plaintext highlighter-rouge">xclip</code> to directly operate on the three types of clipboards in X Window System. Its option <code class="language-plaintext highlighter-rouge">-selection</code> is used to specify which clipboard is to be used. Possible values are <code class="language-plaintext highlighter-rouge">primary</code>, <code class="language-plaintext highlighter-rouge">secondary</code> and <code class="language-plaintext highlighter-rouge">clipboard</code>. If <code class="language-plaintext highlighter-rouge">xclip</code> is further combined with other Linux commands via pipes,</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">command</span> | xclip <span class="nt">-selection</span> clipboard
</code></pre></div></div>

<p>some tasks frequented in our work can be automated. For example, we can copy the current absolute path into the clipboard as below. Note that the second command in the pipeline is to remove the trailing newline character in the output from <code class="language-plaintext highlighter-rouge">pwd</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">pwd</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'\n'</span> | xclip <span class="nt">-selection</span> clipboard
</code></pre></div></div>

<p>We can also copy the current folder name into the clipboard with the help of <code class="language-plaintext highlighter-rouge">basename</code>. Its option <code class="language-plaintext highlighter-rouge">-z</code> ends its output string with <code class="language-plaintext highlighter-rouge">NULL</code> instead of newline.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">basename</span> <span class="nt">-z</span> <span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span> | xclip <span class="nt">-selection</span> clipboard
</code></pre></div></div>

<p>Moreover, an image in the clipboard which is acquired by a screen capturing tool, e.g. Spectacle on KDE, can be automatically saved into a file with the current time stamp as the file name. In the following Bash script <code class="language-plaintext highlighter-rouge">cpimg.sh</code>, I use the option <code class="language-plaintext highlighter-rouge">-t TARGETS -o</code> of <code class="language-plaintext highlighter-rouge">xclip</code> to get the type of the content in the clipboard, then make sure it is actually a PNG image by using <code class="language-plaintext highlighter-rouge">grep</code>. The formatted time stamp is obtained from <code class="language-plaintext highlighter-rouge">date</code>. The image will be saved into the folder <code class="language-plaintext highlighter-rouge">${default_path}</code>, which is specified via the command line option <code class="language-plaintext highlighter-rouge">-p</code>. User can also specify a descriptive file name, which will be appended to the time stamp.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">script_name</span><span class="o">=</span><span class="s2">"cpimg.sh"</span>
<span class="nv">script_usage</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
</span><span class="nv">$script_name</span><span class="sh"> [OPTION] [image-file-name]
</span><span class="no">EOF
</span><span class="si">)</span>
<span class="nv">script_function</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
Save the image in the clipboard to a PNG file. The file name is
optional. The default file name uses the current date and time string.
</span><span class="no">EOF
</span><span class="si">)</span>
<span class="nv">script_doc</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
Script documentation.
-h     Display this help.
-p     Path to the image file, which should end with a slash.
</span><span class="no">EOF
</span><span class="si">)</span>
<span class="nv">script_examples</span><span class="o">=</span><span class="si">$(</span><span class="nb">cat</span> <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
</span><span class="nv">$script_name</span><span class="sh"> -p ./figures/ my_image
</span><span class="no">EOF
</span><span class="si">)</span>
<span class="nv">state_prefix</span><span class="o">=</span><span class="s2">"==="</span>
<span class="nv">warning_prefix</span><span class="o">=</span><span class="s2">"***"</span>
<span class="nv">error_prefix</span><span class="o">=</span><span class="s2">"!!!"</span>

<span class="k">function </span>display_help<span class="o">()</span> <span class="o">{</span>
    <span class="k">if</span> <span class="o">[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$script_usage</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"Usage: </span><span class="nv">$script_usage</span><span class="s2">"</span>
    <span class="k">fi

    if</span> <span class="o">[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$script_function</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="nv">$script_function</span><span class="s2">"</span>
    <span class="k">fi

    if</span> <span class="o">[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$script_doc</span><span class="s2">"</span> <span class="o">]</span> <span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="nv">$script_doc</span><span class="s2">"</span>
    <span class="k">fi

    if</span> <span class="o">[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$script_examples</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Examples"</span>
        <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="nv">$script_examples</span><span class="s2">"</span>
    <span class="k">fi</span>
<span class="o">}</span>

<span class="c"># Default path for the image file.</span>
<span class="nv">default_path</span><span class="o">=</span><span class="s2">"./"</span>

<span class="c"># Process command options</span>
<span class="k">while </span><span class="nb">getopts</span> <span class="s2">":hp:"</span> opt<span class="p">;</span> <span class="k">do
    case</span> <span class="nv">$opt</span> <span class="k">in
        </span>p  <span class="p">)</span>  <span class="nv">default_path</span><span class="o">=</span><span class="nv">$OPTARG</span> <span class="p">;;</span>
        h  <span class="p">)</span>  display_help
            <span class="nb">exit </span>0 <span class="p">;;</span>
        <span class="se">\?</span> <span class="p">)</span>  display_help
            <span class="nb">exit </span>1 <span class="p">;;</span>
    <span class="k">esac</span>
<span class="k">done
</span><span class="nb">shift</span> <span class="k">$((</span><span class="nv">$OPTIND</span> <span class="o">-</span> <span class="m">1</span><span class="k">))</span>

<span class="c"># Check if the path exists.</span>
<span class="k">if</span> <span class="o">[</span> <span class="o">!</span> <span class="nt">-d</span> <span class="s2">"</span><span class="nv">$default_path</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$error_prefix</span><span class="s2"> The target path does not exist!"</span>
<span class="k">else
    </span><span class="nv">target_type</span><span class="o">=</span><span class="sb">`</span>xclip <span class="nt">-selection</span> clipboard <span class="nt">-t</span> TARGETS <span class="nt">-o</span> | <span class="nb">grep</span> <span class="s2">"image/png"</span><span class="sb">`</span>

    <span class="k">if</span> <span class="o">[</span> <span class="nt">-n</span> <span class="s2">"</span><span class="nv">$target_type</span><span class="s2">"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nv">timestamp</span><span class="o">=</span><span class="sb">`</span><span class="nb">date</span> +%F_%H-%M-%S<span class="sb">`</span>

        <span class="c"># If there is an argument, append it to the default file name.</span>
        <span class="k">if</span> <span class="o">[</span> <span class="nv">$# </span><span class="o">=</span> <span class="s2">"1"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
            </span><span class="nv">file_name</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">default_path</span><span class="k">}${</span><span class="nv">timestamp</span><span class="k">}</span><span class="s2">-</span><span class="nv">$1</span><span class="s2">.png"</span>
        <span class="k">else
            </span><span class="nv">file_name</span><span class="o">=</span><span class="s2">"</span><span class="k">${</span><span class="nv">default_path</span><span class="k">}${</span><span class="nv">timestamp</span><span class="k">}</span><span class="s2">.png"</span>
        <span class="k">fi

        </span>xclip <span class="nt">-selection</span> clipboard <span class="nt">-t</span> image/png <span class="nt">-o</span> <span class="o">&gt;</span> <span class="s2">"</span><span class="nv">$file_name</span><span class="s2">"</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$error_prefix</span><span class="s2"> The content in the clipboard cannot be saved as a PNG image!"</span>
    <span class="k">fi
fi</span>
</code></pre></div></div>

<p>Backlinks: <a href="/computer/2022/07/30/open-hyperlink-to-joplin-note-from-pdf.html">《Open hyperlink to Joplin note from PDF》</a></p>

  </div><a class="u-url" href="/computer/2022/05/28/clipboards-in-X-Window-System.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">止于至善</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Jihuan Tian</li><li><a class="u-email" href="mailto:jihuan_tian@hotmail.com">jihuan_tian@hotmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>As regards numerical analysis, mathematical electromagnetism, Linux techniques and personal thoughts.</p>
      </div>
      <div class="footer-col">
        <p>The articles are under a <a href='http://creativecommons.org/licenses/by-nc-sa/4.0/'>Creative Commons Attribution License</a>. Copyright &copy; 2025 <a href="mailto:jihuan_tian@hotmail.com">Jihuan Tian</a>.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
