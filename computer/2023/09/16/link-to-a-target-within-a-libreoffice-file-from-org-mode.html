<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Link to a target within a LibreOffice file from Org mode | 止于至善</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="Link to a target within a LibreOffice file from Org mode" />
<meta name="author" content="Jihuan Tian" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In Org mode, to create a hyperlink which points to an internal target, such as heading, table, bookmark, etc., in a local LibreOffice document, should be an URL instead of an absolute or relative file system path, otherwise it cannot be opened by the libreoffice program. To generate such an URL, the path to the local LibreOffice file should be converted to an absolute one and prefixed with file://. The target in the LibreOffice document for linking should be appended to the URL in the form #&lt;target-name&gt;|&lt;target-category&gt;. The &lt;target-name&gt; can be checked within LibreOffice’s navigator. The &lt;target-category&gt; can be outline, table, figure, etc. Then special characters within the URL should be converted to URL encoding. For example, a white space should be represented as %20." />
<meta property="og:description" content="In Org mode, to create a hyperlink which points to an internal target, such as heading, table, bookmark, etc., in a local LibreOffice document, should be an URL instead of an absolute or relative file system path, otherwise it cannot be opened by the libreoffice program. To generate such an URL, the path to the local LibreOffice file should be converted to an absolute one and prefixed with file://. The target in the LibreOffice document for linking should be appended to the URL in the form #&lt;target-name&gt;|&lt;target-category&gt;. The &lt;target-name&gt; can be checked within LibreOffice’s navigator. The &lt;target-category&gt; can be outline, table, figure, etc. Then special characters within the URL should be converted to URL encoding. For example, a white space should be represented as %20." />
<link rel="canonical" href="https://jihuan-tian.github.io/computer/2023/09/16/link-to-a-target-within-a-libreoffice-file-from-org-mode.html" />
<meta property="og:url" content="https://jihuan-tian.github.io/computer/2023/09/16/link-to-a-target-within-a-libreoffice-file-from-org-mode.html" />
<meta property="og:site_name" content="止于至善" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-09-16T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Link to a target within a LibreOffice file from Org mode" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jihuan Tian"},"dateModified":"2023-09-16T00:00:00+08:00","datePublished":"2023-09-16T00:00:00+08:00","description":"In Org mode, to create a hyperlink which points to an internal target, such as heading, table, bookmark, etc., in a local LibreOffice document, should be an URL instead of an absolute or relative file system path, otherwise it cannot be opened by the libreoffice program. To generate such an URL, the path to the local LibreOffice file should be converted to an absolute one and prefixed with file://. The target in the LibreOffice document for linking should be appended to the URL in the form #&lt;target-name&gt;|&lt;target-category&gt;. The &lt;target-name&gt; can be checked within LibreOffice’s navigator. The &lt;target-category&gt; can be outline, table, figure, etc. Then special characters within the URL should be converted to URL encoding. For example, a white space should be represented as %20.","headline":"Link to a target within a LibreOffice file from Org mode","mainEntityOfPage":{"@type":"WebPage","@id":"https://jihuan-tian.github.io/computer/2023/09/16/link-to-a-target-within-a-libreoffice-file-from-org-mode.html"},"url":"https://jihuan-tian.github.io/computer/2023/09/16/link-to-a-target-within-a-libreoffice-file-from-org-mode.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/font.css">
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/htmlize-syntax-highlight.css">
  
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico?">
  <link href="https://fonts.googlefonts.cn/css?family=EB+Garamond" rel="stylesheet"><link type="application/atom+xml" rel="alternate" href="https://jihuan-tian.github.io/feed.xml" title="止于至善" />
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">止于至善</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <!-- Enforce a fixed order for my categories. -->
          <a class="page-link" href="/math/">Math</a>
          <a class="page-link" href="/computer/">Computer</a>
          <a class="page-link" href="/thoughts/">Thoughts</a>
          <a class="page-link" href="/tags/">Tags</a>
          <a class="page-link" href="/about/">About</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Link to a target within a LibreOffice file from Org mode</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2023-09-16T00:00:00+08:00" itemprop="datePublished">Sep 16, 2023 &nbsp;

        
          Categories:
          
            <a href="/computer">Computer</a>
          
         &nbsp;
        
          Tags:
          
            <a href="/tags/Emacs">Emacs</a>
          
            <a href="/tags/Org-mode">Org-mode</a>
          
            <a href="/tags/LibreOffice">LibreOffice</a>
          
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In Org mode, to create a hyperlink which points to an internal target, such as heading, table, bookmark, etc., in a local LibreOffice document, should be an URL instead of an absolute or relative file system path, otherwise it cannot be opened by the <code class="language-plaintext highlighter-rouge">libreoffice</code> program. To generate such an URL, the path to the local LibreOffice file should be converted to an absolute one and prefixed with <code class="language-plaintext highlighter-rouge">file://</code>. The target in the LibreOffice document for linking should be appended to the URL in the form <code class="language-plaintext highlighter-rouge">#&lt;target-name&gt;|&lt;target-category&gt;</code>. The <code class="language-plaintext highlighter-rouge">&lt;target-name&gt;</code> can be checked within LibreOffice’s navigator. The <code class="language-plaintext highlighter-rouge">&lt;target-category&gt;</code> can be <code class="language-plaintext highlighter-rouge">outline</code>, <code class="language-plaintext highlighter-rouge">table</code>, <code class="language-plaintext highlighter-rouge">figure</code>, etc. Then special characters within the URL should be converted to URL encoding. For example, a white space should be represented as <code class="language-plaintext highlighter-rouge">%20</code>.</p>

<p>A new link type <code class="language-plaintext highlighter-rouge">libreoffice</code> can be created in Org as below.</p>

<div class="language-elisp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">;; Open a LibreOffice file with specified internal target, i.e. with pinpoint</span>
<span class="c1">;; accuracy.</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">tjh/open-libreoffice-file-target</span> <span class="p">(</span><span class="nv">url</span><span class="p">)</span>
  <span class="p">(</span><span class="nv">start-process</span> <span class="s">"LibreOffice file target"</span> <span class="no">nil</span> <span class="s">"libreoffice"</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"file://"</span> <span class="p">(</span><span class="nv">url-encode-url</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">url</span><span class="p">)))))</span>

<span class="c1">;; Completion for inserting the LibreOffice link, which is copied from</span>
<span class="c1">;; org-link-complete-file.</span>
<span class="p">(</span><span class="nb">defun</span> <span class="nv">libreoffice-link-complete-file</span> <span class="p">(</span><span class="k">&amp;optional</span> <span class="nv">arg</span><span class="p">)</span>
  <span class="s">"Create a file link using completion."</span>
  <span class="p">(</span><span class="k">let</span> <span class="p">((</span><span class="nv">file</span> <span class="p">(</span><span class="nv">read-file-name</span> <span class="s">"LibreOffice: "</span><span class="p">))</span>
        <span class="p">(</span><span class="nv">pwd</span> <span class="p">(</span><span class="nv">file-name-as-directory</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"."</span><span class="p">)))</span>
        <span class="p">(</span><span class="nv">pwd1</span> <span class="p">(</span><span class="nv">file-name-as-directory</span> <span class="p">(</span><span class="nv">abbreviate-file-name</span>
                                       <span class="p">(</span><span class="nv">expand-file-name</span> <span class="s">"."</span><span class="p">)))))</span>
    <span class="p">(</span><span class="nb">cond</span> <span class="p">((</span><span class="nb">equal</span> <span class="nv">arg</span> <span class="o">'</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
           <span class="p">(</span><span class="nv">concat</span> <span class="s">"libreoffice:"</span>
                   <span class="p">(</span><span class="nv">abbreviate-file-name</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">file</span><span class="p">))))</span>
          <span class="p">((</span><span class="nv">string-match</span>
            <span class="p">(</span><span class="nv">concat</span> <span class="s">"^"</span> <span class="p">(</span><span class="nv">regexp-quote</span> <span class="nv">pwd1</span><span class="p">)</span> <span class="s">"\\(.+\\)"</span><span class="p">)</span> <span class="nv">file</span><span class="p">)</span>
           <span class="p">(</span><span class="nv">concat</span> <span class="s">"libreoffice:"</span> <span class="p">(</span><span class="nv">match-string</span> <span class="mi">1</span> <span class="nv">file</span><span class="p">)))</span>
          <span class="p">((</span><span class="nv">string-match</span>
            <span class="p">(</span><span class="nv">concat</span> <span class="s">"^"</span> <span class="p">(</span><span class="nv">regexp-quote</span> <span class="nv">pwd</span><span class="p">)</span> <span class="s">"\\(.+\\)"</span><span class="p">)</span>
            <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">file</span><span class="p">))</span>
           <span class="p">(</span><span class="nv">concat</span> <span class="s">"libreoffice:"</span>
                   <span class="p">(</span><span class="nv">match-string</span> <span class="mi">1</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">file</span><span class="p">))))</span>
          <span class="c1">;; N.B. Since a local LibreOffice document is linked, the relative</span>
          <span class="c1">;; path is preferred.</span>
          <span class="p">(</span><span class="no">t</span> <span class="p">(</span><span class="nv">concat</span> <span class="s">"libreoffice:"</span> <span class="p">(</span><span class="nv">file-relative-name</span> <span class="p">(</span><span class="nv">expand-file-name</span> <span class="nv">file</span><span class="p">)))))))</span>

<span class="c1">;; Set the behavior of opening the LibreOffice link and inserting the link with</span>
<span class="c1">;; completion.</span>
<span class="p">(</span><span class="nv">org-link-set-parameters</span>
 <span class="s">"libreoffice"</span>
 <span class="ss">:follow</span> <span class="ss">'tjh/open-libreoffice-file-target</span>
 <span class="ss">:complete</span> <span class="ss">'libreoffice-link-complete-file</span><span class="p">)</span>
</code></pre></div></div>

<p>N.B. For me there is no need to modify the link’s <code class="language-plaintext highlighter-rouge">export</code> behavior, because when I export the Org file to LaTeX PDF, the link format generated by the default export back-end is effective when it is clicked from a PDF viewer.</p>


  </div><a class="u-url" href="/computer/2023/09/16/link-to-a-target-within-a-libreoffice-file-from-org-mode.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">止于至善</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Jihuan Tian</li><li><a class="u-email" href="mailto:jihuan_tian@hotmail.com">jihuan_tian@hotmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://mastodon.social/@hypersingular"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#mastodon"></use></svg> <span class="username">hypersingular</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>As regards numerical analysis, mathematical electromagnetism, Linux techniques and personal thoughts.</p>
      </div>
      <div class="footer-col">
        <p>The articles are under a <a href='http://creativecommons.org/licenses/by-nc-sa/4.0/'>Creative Commons Attribution License</a>. Copyright &copy; 2025 <a href="mailto:jihuan_tian@hotmail.com">Jihuan Tian</a>.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
