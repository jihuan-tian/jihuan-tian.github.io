---
layout: post
title: 使用LibreOffice Writer构建个人日志系统
date: 2020-07-27
---

日志是我们记录个人经历与想法的不可或缺的工具。通过写日志这一过程，我们的逻辑思维得到了充分训练，表能与写作能力也会逐步改善。而对于日志软件的选择，我个人建议使用开源软件而非商业软件。这样一来，我们便可以长期免费地使用同一个软件工具，保证数据与文件格式的一致性，持续增强自身使用该工具的水平，从而不断提高生产力。即便开源软件的功能与性能暂时不如商业软件，但以发展的眼光来看，随着时间的推移，开源软件也在不断改进，最终会赶上甚至是超过商业软件。以LibreOffice为例，我大约在15年前就已经开始使用了。虽然那个时候它的部分功能尚存在bug，但如今均已完全修复，且拥有很多微软Office不具备的优秀功能。

其次，写日志需要的是形象而非抽象思维，所以我们最好使用所见及所得的编辑工具。“所见及所得”这一特点能够方便快捷地在屏幕文本与人的情感层（visceral）之间建立纽带——例如，字体的大小、高亮的颜色、留白处的批注等都为我们提供了写作过程中的一种情境与暗示。这种潜移默化的效果确保了写作思路的流畅，并使我们专注于构思、设计、表达与创作，还能获得由此带来的快乐和满足感。这一点是Markdown、LaTeX等将写作变得如同编程一样的工具无法或较难实现的。

基于以上两点考虑，LibreOffice套件中的Writer能够完全满足我们写日志的要求。从2006年至今，我已经在LibreOffice Writer中写下了近85万字。所以，对于如何使用LibreOffice Writer管理与组织这些内容也有了一点经验，以下便向各位予以介绍。

## 使用基于相对路径的超链接将日志关联起来

写日志的过程中，时常会想起和参考以前的一些记录，主日志文件中也会引用到与不同项目对应的工作日志，在文本中插入的示意图、思维导图等资源也往往需要与它们的源文件相关联，从而方便再编辑。这个时候就需要用大量的超链接将不同的文档以及资源文件用类似于维基百科中的链接一样彼此联系起来，形成记录与知识的网状结构。这种形式超越了仅用文件夹来组织文件内容的简单而局限的树状结构。注：关于超链接，可以参考《创新者》第八章“个人电脑”：

> 个人电脑（即普通人能够亲手操作并带到家中使用的电脑）这一思想是万尼瓦尔·布什1945年提出的。布什曾在麻省理工学院建成了大型模拟计算机，并协助构建了军、企、学三角协作体系，在此之后，他为1945年7月号的《大西洋月刊》（Atlantic）撰写了一篇题为《诚如所思》的文章。在这篇文章中，布什设想了一种他称之为“记忆扩展器”（memex）的个人电脑，这种电脑能够存储和调阅一个人的言论、图片和其他信息，

> 布什设想，这种设备会配有键盘之类的“直接输入”装置，使用户能够将信息和记录输入存储器。他甚至预言了超文本链接和文件共享，还设想了进行项目合作的方式。他写道：“全新的百科全书将会出现，它们之间预先设置了由关联路径构成的网络，等待放入记忆扩展器，在记忆扩展器中，它们将得到拓展。”这段话预见了半个世纪之后的维基百科。

与微软Office不同，如果链接的目标文件也是LibreOffice Writer文件，则在LibreOffice Writer源文件中创建的超链接可以直接定位到目标文件中指定的某个章节标题（Headings）、表格、图片、OLE对象、节或者书签。如图1所示，在超链接设置对话框中选定了链接目标文件后，这一点可在“Target in document”一栏中予以设定：点击红框内右侧的按钮，则会弹出类似文档导航栏的窗口（如图2所示），从中即可以选择需要链接的对象。

![](/figures/p74682092.jpg)

图1 超链接设置对话框

![](/figures/p74682096.jpg)

图2 目标文件中的链接对象

由于个人文档需要备份和同步到不同的设备上，包括移动硬盘、U盘、台式机、笔记本电脑等，而文档在不同设备上的绝对路径可能是不同的。所以，为了保证上述超链接的有效性，链接地址需要使用文件的相对路径而不是绝对路径。如图3所示，这一点可以在软件设置中“Load/Save”栏目下的“General”中选择“Save URLs relative to file system”。

![](/figures/p74682110.jpg)

图3 设置使用文件系统相对URL地址

## 给日志条目加标签进行分类

给日志添加标签是分类组织信息的非常有效的方法，这也是常见博客平台的基本功能。然而对于文字处理软件LibreOffice Writer来说，其设计初衷是为了排版和出版，而非信息的结构化与分类化组织，因而自然就没有这项功能了。不过，我们仍可以通过在日志章节标题处插入可以自动计数的“Number range”域的方式来生成标签。然后，再针对该“域”生成与标签相关的所有日志标题的目录（table of contents）。如图4所示，我创建了诸如“小结与回顾”、“数学”、“豆瓣”等标签。在需要给日志分类的时候，在其标题后插入相应的域即可（如图5所示）。为该标签生成的日志目录则如图6所示。

![](/figures/p74682116.jpg)

图4 使用Number range域创建日志分类标签

![](/figures/p74682118.jpg)

图5 在日志标题处插入分类标签

![](/figures/p74682120.jpg)

图6 包含“豆瓣”标签的日志目录

## 直接引用外部文档内容并保持同步

使用本文前面所说的超链接可以在不同文档间的标题、图、表等对象间建立关联，实现快速跳转，但却无法实现在当前文档中引用另一文档中的某部分原文并保持同步。对此，我们一般采用的笨办法是将引用的文字直接拷贝到当前文档中。然而，若这些内容在另一文档中被修改，为了保证两边的一致性，还需要再手动拷贝一遍。当引用的内容片段较多或者在多个文档间都存在这样的引用时，通过手动拷贝实现同步就会变得费时费力且极易出错，几乎无法维护。对此，可以使用LibreOffice Writer导航栏中提供的“Drag mode”功能。点击如图7所示的按钮，选择弹出菜单中的“Insert as Hyperlink”。然后在目标文档中用鼠标选中想要引用的那部分内容（文字、图片均可），直接拖到当前文档中的指定位置即可实现引用并保持同步了。

![](/figures/p74682121.jpg)

图7 LibreOffice Writer导航栏中的“Drag mode”

## 总结

通过本文以上介绍的方法和技巧，我们便可以使用开源软件LibreOffice构建起强大、稳定、可靠的个人日志系统。通过标签分类与创建目录，大量的日志内容得到了很好的管理与组织。通过精确到文档内部指定对象与位置的超链接和引用，形成了相互联接、可快速跳转的记录与知识的网络。这也算是在一定程度上实现了恩格尔巴特关于将计算机作为人类[增智系统](https://book.douban.com/annotation/48695180/)的设想吧。
