<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The interplay between triangulation, manifold, mapping, quadrature point and finite element | 止于至善</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="The interplay between triangulation, manifold, mapping, quadrature point and finite element" />
<meta name="author" content="Jihuan Tian" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In FEM or BEM, the five entities, namely triangulation, manifold, mapping, quadrature point and finite element, work together to discretize the spatial domain and prepare necessary data for cellwise computation. This article explains their functions and relationships." />
<meta property="og:description" content="In FEM or BEM, the five entities, namely triangulation, manifold, mapping, quadrature point and finite element, work together to discretize the spatial domain and prepare necessary data for cellwise computation. This article explains their functions and relationships." />
<link rel="canonical" href="https://jihuan-tian.github.io/math/2024/09/24/the-interplay-between-triangulation-manifold-mapping-quadrature-point-and-finite-element.html" />
<meta property="og:url" content="https://jihuan-tian.github.io/math/2024/09/24/the-interplay-between-triangulation-manifold-mapping-quadrature-point-and-finite-element.html" />
<meta property="og:site_name" content="止于至善" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-09-24T00:00:00+08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The interplay between triangulation, manifold, mapping, quadrature point and finite element" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jihuan Tian"},"dateModified":"2024-09-24T00:00:00+08:00","datePublished":"2024-09-24T00:00:00+08:00","description":"In FEM or BEM, the five entities, namely triangulation, manifold, mapping, quadrature point and finite element, work together to discretize the spatial domain and prepare necessary data for cellwise computation. This article explains their functions and relationships.","headline":"The interplay between triangulation, manifold, mapping, quadrature point and finite element","mainEntityOfPage":{"@type":"WebPage","@id":"https://jihuan-tian.github.io/math/2024/09/24/the-interplay-between-triangulation-manifold-mapping-quadrature-point-and-finite-element.html"},"url":"https://jihuan-tian.github.io/math/2024/09/24/the-interplay-between-triangulation-manifold-mapping-quadrature-point-and-finite-element.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/font.css">
  <link rel="stylesheet" href="/assets/main.css">
  <link rel="stylesheet" href="/assets/css/htmlize-syntax-highlight.css">
  
  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico?">
  <link href="https://fonts.googlefonts.cn/css?family=EB+Garamond" rel="stylesheet">
  <script type='text/javascript' src='https://platform-api.sharethis.com/js/sharethis.js#property=67ba859acde8790019eafb38&product=inline-share-buttons' async='async'></script><link type="application/atom+xml" rel="alternate" href="https://jihuan-tian.github.io/feed.xml" title="止于至善" />
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    jax: ["input/TeX", "output/SVG"],
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/noUndefined.js", "TeX/AMScd.js"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      skipTags: ["script","noscript","style","textarea","pre","code"],
      processEscapes: true,
      processEnvironments: true,
      preview: "TeX"
    },
    TeX: {
      Macros: {
        intd: "\\,{\\rm d}",
        diff: "{\\rm d}",
        Diff: "{\\rm D}",
        pdiff: "\\partial",
        DD: ["\\frac{\\diff}{\\diff #2}\\left( #1 \\right)", 2],
        Dd: ["\\frac{\\diff #1}{\\diff #2}", 2],
        PD: ["\\frac{\\pdiff}{\\pdiff #2}\\left( #1 \\right)", 2],
        Pd: ["\\frac{\\pdiff #1}{\\pdiff #2}", 2],
        rme: "{\\rm e}",
        rmi: "{\\rm i}",
        rmj: "{\\rm j}",
        vect: ["\\boldsymbol{#1}", 1],
        dform: ["\\overset{\\rightharpoonup}{\\boldsymbol{#1}}", 1],
        cochain: ["\\overset{\\rightharpoonup}{#1}", 1],
        bigabs: ["\\bigg\\lvert#1\\bigg\\rvert", 1],
        Abs: ["\\big\\lvert#1\\big\\rvert", 1],
        abs: ["\\lvert#1\\rvert", 1],
        bignorm: ["\\bigg\\lVert#1\\bigg\\rVert", 1],
        Norm: ["\\big\\lVert#1\\big\\rVert", 1],
        norm: ["\\lVert#1\\rVert", 1],
        normvect: "\\vect{n}",
        ouset: ["\\overset{#3}{\\underset{#2}{#1}}", 3],
        cscript: ["\\;\\; #1", 1],
        suchthat: "\\textit{S.T. }",
        prefstar: "\\ast",
        restrict: "\\big\\vert",
        sgn: "{\\rm sgn}",
        erf: "{\\rm erf}",
        Bd: "{\\rm Bd}",
        Int: "{\\rm Int}",
        dim: "{\\rm dim}",
        rank: "{\\rm rank}",
        range: "{\\rm range}",
        divergence: "{\\rm div}",
        curl: "{\\rm curl}",
        grad: "{\\rm grad}",
        tr: "{\\rm tr}",
        lhs: "{\\rm LHS}",
        rhs: "{\\rm RHS}",
        span: "{\\rm span}",
        diag: "{\\rm diag}",
        argmin: "{\\rm argmin}",
        argmax: "{\\rm argmax}",
        esssup: "{\\rm esssup}",
        essinf: "{\\rm essinf}",
        kernel: "{\\rm ker}",
        image: "{\\rm Im}",
        diam: "{\\rm diam}",
        dist: "{\\rm dist}",
        const: "{\\rm const}"
      },
      equationNumbers: { autoNumber: "AMS" }
    }
  });
</script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_SVG"></script>

  
</head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">止于至善</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
          <!-- Enforce a fixed order for my categories. -->
          <a class="page-link" href="/math/">Math</a>
          <a class="page-link" href="/computer/">Computer</a>
          <a class="page-link" href="/thoughts/">Thoughts</a>
          <a class="page-link" href="/tags/">Tags</a>
          <a class="page-link" href="/search/">Search</a>
          <a class="page-link" href="/about/">About</a>
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">The interplay between triangulation, manifold, mapping, quadrature point and finite element</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2024-09-24T00:00:00+08:00" itemprop="datePublished">Sep 24, 2024 &nbsp;

        
          Categories:
          
            <a href="/math">Math</a>
          
         &nbsp;
        
          Tags:
          
            <a href="/tags/BEM">BEM</a>
          
        
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>In FEM or BEM, the five entities, namely triangulation, manifold, mapping, quadrature point and finite element, work together to discretize the spatial domain and prepare necessary data for cellwise computation. This article explains their functions and relationships.</p>

<p><img src="/figures/2024-09-23_21-14-52-interplay-of-triangulation-manifold-mapping-etc.png" alt="img" /></p>

<ol>
  <li>
    <p>Triangulation</p>

    <p>A triangulation describes the topological relationship between vertices and cells. It contains these data:</p>
    <ul>
      <li>Coordinates for vertices</li>
      <li>A cell is represented as an ordered list of vertex indices. This order is consistent with the normal direction of the cell and the cell normal inherits from the normal direction of the geometric entity to which the cell belongs.</li>
    </ul>
  </li>
  <li>
    <p>Manifold</p>

    <p>A manifold is used to generate new <strong>geometry-conforming</strong> points in a cell in the triangulation. For example, two vertices defines an edge of a cell and a new point in the middle of this edge is computed as a weighted average of the two vertices. Similarly, given four vertices of a quadrangular cell, a new point in the center of this cell is computed as a weighted average of the four vertices.</p>

    <p>Generating new points in a cell is needed in two cases:</p>

    <ul>
      <li>Mesh refinement</li>
      <li>Define the support points of mapping shape functions, if the Lagrange type mapping is adopted.</li>
    </ul>
  </li>
  <li>
    <p>Mapping</p>

    <p>A mapping object has two purposes:</p>

    <ul>
      <li>Defines a map from the unit/reference cell to a real cell. When coming to a different real cell in the triangulation, the mathematical function implied by this map changes because the coordinates of the cell vertices are different. With the language of differential geometry, the mapping object assigns a locate coordinate chart to each cell in the triangulation. The local coordinate charts from all cells form an atlas over the triangulation.</li>
      <li>Compute quantities such as Jacobian matrices and determinants, normal vectors and covariant transformation matrices, etc.
        <ul>
          <li>A Jacobian matrix is used to transform a tangent vector from the local coordinate chart to the global Cartesian frame.</li>
          <li>The Jacobian determinant is used when an integral is pulled back from the global Cartesian frame to the local coordinate chart.</li>
          <li>For a surface cell with a manifold dimension 2 and a spatial dimension 3, the normal vector at a point in this cell is the cross product of the two basis vectors for the local coordinate chart. Some BEM kernel functions such as the double layer kernel and its adjoint need the normal vector information.</li>
          <li>
            <p>The covariant matrix is used to transform a gradient vector from the local coordinate chart to the global Cartesian frame. The procedure is</p>

            <ul>
              <li>Transform the 1-form in the local coordinate chart to tangent vector via the inverse of the metric tensor $G^{-1} $.</li>
              <li>Push forward the tangent vector in the local coordinate chart to the global Cartesian frame via the Jacobian matrix $J $.</li>
            </ul>

            <p>The total transformation is the covariant matrix $J G^{-1} $.</p>
          </li>
        </ul>
      </li>
    </ul>

    <p>Examples of mapping objects:</p>

    <ul>
      <li>
        <p>Lagrange type mapping</p>

        <p>It uses Lagrange polynomials as shape functions to construct the map from the unit cell to a real cell. The non-zero part of each shape function concentrates around a support point. Therefore, the higher the order of the polynomials, the more the shape functions and hence the more the support points. When the polynomial order is 1, i.e. the map is linear, the four vertices of a cell are just the support points of all the four shape functions. When the polynomial order is larger than 1, more support points are needed which are located either in the middle of edges or in the cell interior. As mentioned above, the generation of these intermediate support points needs to consult the manifold object.</p>
      </li>
      <li>
        <p>Manifold conforming mapping</p>

        <p>In this case, the map from the unit cell to a real cell conforms exactly with the manifold. The computation of quantities such as Jacobian matrices and determinants etc. will depend on how the manifold is defined.</p>
      </li>
    </ul>
  </li>
  <li>
    <p>Quadrature points</p>

    <p>Quadrature points are generated in the unit cell. With a mapping object, they can be transformed to points in a real cell.</p>
  </li>
  <li>
    <p>Finite element</p>

    <p>The evaluation of the shape functions and their derivatives for a finite element is performed at all quadrature points in the unit cell. These are fixed values, which can be precomputed and stored. The vector forms of differential forms in the global Cartesian frame can be computed from these fixed values and transformed to a real cell with the help of the mapping object. And the mapping object further depends on the manifold object.</p>
  </li>
</ol>


  </div><div class="sharethis-inline-share-buttons"></div>

  <script src="https://utteranc.es/client.js"
          repo="jihuan-tian/jihuan-tian.github.io"
          issue-term="pathname"
          theme="github-light"
          crossorigin="anonymous"
          async>
  </script>

  <a class="u-url" href="/math/2024/09/24/the-interplay-between-triangulation-manifold-mapping-quadrature-point-and-finite-element.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">止于至善</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Jihuan Tian</li><li><a class="u-email" href="mailto:jihuan_tian@hotmail.com">jihuan_tian@hotmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>RSS</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>As regards numerical analysis, mathematical electromagnetism, Linux techniques and personal thoughts.</p>
      </div>
      <div class="footer-col">
        <p>The articles are under a <a href='http://creativecommons.org/licenses/by-nc-sa/4.0/'>Creative Commons Attribution License</a>. Copyright &copy; 2025 <a href="mailto:jihuan_tian@hotmail.com">Jihuan Tian</a>.</p>
      </div>
    </div>
  </div>

</footer>
</body>

</html>
